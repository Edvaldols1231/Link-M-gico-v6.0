<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkM√°gico v6.0 + v7.0 Integrado</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            color: white;
        }

        /* Header com tema dark */
        .header {
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
        }

        .version-badge {
            display: inline-block;
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #000;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 25px rgba(0, 255, 136, 0.5); }
            100% { transform: scale(1); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3); }
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .logo {
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 1rem;
            border-radius: 15px;
            font-size: 2rem;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        /* Tema dark para se√ß√µes */
        .section {
            background: linear-gradient(145deg, #2c3e50, #34495e);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .section h2 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #ecf0f1;
        }

        .section p {
            opacity: 0.8;
            margin-bottom: 1.5rem;
            line-height: 1.6;
            color: #bdc3c7;
        }

        /* Formul√°rio com tema dark */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #ecf0f1;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
            outline: none;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-decoration: none;
            text-align: center;
            margin: 0.5rem;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #000;
        }

        .btn-info {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        /* Analytics com tema dark */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .analytics-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .analytics-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, #00ff88, #667eea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .analytics-label {
            opacity: 0.7;
            font-size: 0.9rem;
            color: #bdc3c7;
        }

        /* Preview do chatbot melhorado */
        .chat-preview {
            background: rgba(0, 0, 0, 0.4);
            padding: 1.5rem;
            border-radius: 15px;
            margin-top: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-preview h4 {
            margin-bottom: 1rem;
            color: #ecf0f1;
        }

        .chat-messages {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding-right: 0.5rem;
        }

        .chat-message {
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 0.8rem;
            border-radius: 15px;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            animation: slideInLeft 0.5s ease-out;
        }

        .chat-message.user {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #000;
            margin-left: 2rem;
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .chat-input {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.8rem;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.3);
            color: white;
        }

        .chat-input button {
            padding: 0.8rem 1.5rem;
            border-radius: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            cursor: pointer;
        }

        /* Bot√µes sociais - layout original com logos */
        .social-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .social-btn {
            padding: 0.8rem;
            border-radius: 10px;
            color: white;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: bold;
            text-align: center;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            border: 2px solid transparent;
        }

        .social-btn:hover {
            transform: scale(1.05);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Cores originais dos bot√µes sociais */
        .whatsapp { background: linear-gradient(45deg, #25d366, #128c7e); }
        .telegram { background: linear-gradient(45deg, #0088cc, #005580); }
        .facebook { background: linear-gradient(45deg, #1877f2, #166fe5); }
        .youtube { background: linear-gradient(45deg, #ff0000, #cc0000); }
        .tiktok { background: linear-gradient(45deg, #000000, #333333); }
        .twitter { background: linear-gradient(45deg, #1da1f2, #0d8bd9); }
        .instagram { background: linear-gradient(45deg, #e1306c, #fd1d1d, #f77737, #fcaf45); }
        .linkedin { background: linear-gradient(45deg, #0077b5, #005885); }
        .messenger { background: linear-gradient(45deg, #006aff, #0053d1); }
        .prompt { background: linear-gradient(45deg, #00ff88, #00cc6a); color: #000; }
        .analytics { background: linear-gradient(45deg, #95a5a6, #7f8c8d); }
        .kwai { background: linear-gradient(45deg, #ff6600, #e55a00); }

        /* Widget code com tema dark */
        .widget-code {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            overflow-x: auto;
            margin-top: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Se√ß√£o v7.0 com tema dark atrativo */
        .v7-features {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 20px;
            padding: 2rem;
            margin: 3rem 0;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .v7-features h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #ecf0f1;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .feature-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        }

        .feature-card h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: #ecf0f1;
        }

        .feature-card p {
            margin-bottom: 1.5rem;
            opacity: 0.8;
            color: #bdc3c7;
        }

        /* Status indicators */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #00ff88;
            border-radius: 50%;
            margin-right: 0.5rem;
            animation: pulse 1s infinite;
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading::after {
            content: '‚è≥';
            margin-left: 0.5rem;
        }

        /* Success states */
        .success {
            background: linear-gradient(45deg, #00ff88, #00cc6a) !important;
            color: #000 !important;
        }

        /* Error states */
        .error {
            background: linear-gradient(45deg, #e74c3c, #c0392b) !important;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .social-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="version-badge">üÜï NOVA VERS√ÉO v6.0 + v7.0 INTEGRADA</div>
        
        <div class="logo-container">
            <div class="logo">ü§ñ</div>
            <div>
                <h1>LinkM√°gico v6.0</h1>
                <div class="subtitle">
                    <span class="status-indicator"></span>
                    IA Conversacional Inteligente + Demos P√∫blicos
                </div>
            </div>
            <div style="position: absolute; top: 1rem; right: 2rem; background: rgba(0, 0, 0, 0.3); padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                <span class="status-indicator"></span>Sistema Online
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Grid principal -->
        <div class="main-grid">
            <!-- Se√ß√£o Criar Chatbot -->
            <div class="section">
                <h2>ü§ñ Criar Chatbot</h2>
                <p>Configure seu assistente de vendas inteligente</p>
                
                <form id="chatbotForm">
                    <div class="form-group">
                        <label>üë§ Nome do Assistente Virtual:</label>
                        <input type="text" id="robotName" placeholder="@arsenal.secreto" value="@arsenal.secreto">
                    </div>
                    
                    <div class="form-group">
                        <label>üîó URL da P√°gina:</label>
                        <input type="url" id="pageUrl" placeholder="https://www.arsenalsecreto.com.br/hot">
                    </div>
                    
                    <div class="form-group">
                        <label>üí° Instru√ß√µes Personalizadas (opcional):</label>
                        <textarea id="instructions" rows="4" placeholder="Ex.: Responda em at√© 3 frases, direto ao ponto, sem floreios. Use os dados vis√≠veis na p√°gina."></textarea>
                        <small style="opacity: 0.7; color: #bdc3c7;">Dica: para respostas curtas (2-3 frases), objetivas e sem repeti√ß√µes.</small>
                    </div>
                    
                    <button type="button" class="btn" id="createChatbotBtn" onclick="createChatbot()">
                        üöÄ Ativar Chatbot Inteligente
                    </button>
                </form>

                <!-- Resultado da extra√ß√£o -->
                <div id="extractionResult" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(0, 0, 0, 0.3); border-radius: 10px;">
                    <h4 style="color: #00ff88; margin-bottom: 0.5rem;">‚úÖ Dados Extra√≠dos:</h4>
                    <div id="extractedContent"></div>
                </div>

                <!-- Bot√µes Sociais com Logos -->
                <div class="social-buttons">
                    <a href="#" class="social-btn whatsapp" onclick="shareToSocial('whatsapp')">
                        <span style="font-size: 1.2rem;">üì±</span>
                        WhatsApp
                    </a>
                    <a href="#" class="social-btn telegram" onclick="shareToSocial('telegram')">
                        <span style="font-size: 1.2rem;">‚úàÔ∏è</span>
                        Telegram
                    </a>
                    <a href="#" class="social-btn facebook" onclick="shareToSocial('facebook')">
                        <span style="font-size: 1.2rem;">üìò</span>
                        Facebook
                    </a>
                    <a href="#" class="social-btn youtube" onclick="shareToSocial('youtube')">
                        <span style="font-size: 1.2rem;">üì∫</span>
                        YouTube
                    </a>
                    <a href="#" class="social-btn tiktok" onclick="shareToSocial('tiktok')">
                        <span style="font-size: 1.2rem;">üéµ</span>
                        TikTok
                    </a>
                    <a href="#" class="social-btn twitter" onclick="shareToSocial('twitter')">
                        <span style="font-size: 1.2rem;">üê¶</span>
                        Twitter
                    </a>
                    <a href="#" class="social-btn instagram" onclick="shareToSocial('instagram')">
                        <span style="font-size: 1.2rem;">üì∑</span>
                        Instagram
                    </a>
                    <a href="#" class="social-btn linkedin" onclick="shareToSocial('linkedin')">
                        <span style="font-size: 1.2rem;">üíº</span>
                        LinkedIn
                    </a>
                    <a href="#" class="social-btn messenger" onclick="shareToSocial('messenger')">
                        <span style="font-size: 1.2rem;">üí¨</span>
                        Messenger
                    </a>
                    <a href="#" class="social-btn prompt" onclick="shareToSocial('prompt')">
                        <span style="font-size: 1.2rem;">ü§ñ</span>
                        Prompt
                    </a>
                    <a href="#" class="social-btn analytics" onclick="openAnalytics()">
                        <span style="font-size: 1.2rem;">üìä</span>
                        Analytics
                    </a>
                    <a href="#" class="social-btn kwai" onclick="shareToSocial('kwai')">
                        <span style="font-size: 1.2rem;">üì±</span>
                        Kwai
                    </a>
                </div>
            </div>

            <!-- Dashboard Analytics -->
            <div class="section">
                <h2>üìä Dashboard Analytics</h2>
                <p>Acompanhe o desempenho do seu chatbot em tempo real</p>
                
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-value" id="botsCount">147</div>
                        <div class="analytics-label">üë§ Chatbots Criados hoje</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-value" id="messagesCount">8937</div>
                        <div class="analytics-label">üí¨ Mensagens enviadas</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-value">100%</div>
                        <div class="analytics-label">üìä Extra√ß√£o de dados</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-value" id="responseTime">3s</div>
                        <div class="analytics-label">‚ö° Tempo de resposta</div>
                    </div>
                </div>

                <!-- Preview do Chatbot Funcional -->
                <div class="chat-preview">
                    <h4>üí¨ Preview do Chatbot</h4>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message">
                            ü§ñ Ol√°! Sou seu assistente especializado. Como posso te ajudar hoje?
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="previewInput" placeholder="Digite sua pergunta...">
                        <button onclick="sendPreviewMessage()">Enviar</button>
                    </div>
                </div>

                <!-- Widget Embed Code -->
                <div style="margin-top: 2rem;">
                    <h4>üîß Widget Embed Code</h4>
                    <p style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 1rem; color: #bdc3c7;">Cole este c√≥digo em qualquer site para adicionar o chatbot flutuante:</p>
                    <div class="widget-code" id="widgetCode">
&lt;!-- LinkM√°gico Chatbot Widget --&gt;
&lt;script&gt;
(function() {
  var config = {
    robotName: '<span id="widgetRobotName">Seu Assistente</span>',
    apiBase: 'https://link-m-gico-v6-0-dx0q.onrender.com'
  };
  var script = document.createElement('script');
  script.src = 'https://link-m-gico-v6-0-dx0q.onrender.com/widget.js';
  script.onload = function() {
    window.LinkMagicoWidget.init(config);
  };
  document.head.appendChild(script);
})();
&lt;/script&gt;
                    </div>
                </div>
            </div>
        </div>

        <!-- SE√á√ÉO v7.0 com tema dark atrativo -->
        <div class="v7-features">
            <h2>üÜï Funcionalidades v7.0 Integradas</h2>
            <p>Explore as novas funcionalidades p√∫blicas e recursos avan√ßados</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <h3>üìä Dashboard Demo</h3>
                    <p>Analytics p√∫blico em tempo real com dados simulados para demonstra√ß√£o</p>
                    <a href="/dashboard/demo" class="btn btn-info" target="_blank">
                        üéØ Acessar Dashboard Demo
                    </a>
                </div>
                
                <div class="feature-card">
                    <h3>üîß Widget Demo</h3>
                    <p>Demonstra√ß√£o completa do widget embed√°vel com chat funcional</p>
                    <a href="/widget/demo" class="btn btn-warning" target="_blank">
                        üí¨ Testar Widget Demo
                    </a>
                </div>
                
                <div class="feature-card">
                    <h3>üìñ Documenta√ß√£o</h3>
                    <p>Guia completo de APIs, exemplos de integra√ß√£o e configura√ß√£o</p>
                    <a href="/docs" class="btn btn-secondary" target="_blank">
                        üìö Ver Documenta√ß√£o
                    </a>
                </div>
                
                <div class="feature-card">
                    <h3>üîç Status APIs</h3>
                    <p>Monitoramento em tempo real das APIs GROQ, OpenAI e OpenRouter</p>
                    <a href="/status" class="btn btn-info" target="_blank">
                        üì° Verificar Status
                    </a>
                </div>
            </div>

            <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(0, 0, 0, 0.3); border-radius: 15px;">
                <h4>üéØ Sistema de IA com Fallback Autom√°tico</h4>
                <div style="display: flex; justify-content: center; gap: 1rem; margin: 1rem 0; flex-wrap: wrap;">
                    <span style="background: linear-gradient(45deg, #00ff88, #00cc6a); color: #000; padding: 0.5rem 1rem; border-radius: 15px;">1¬∫ GROQ API</span>
                    <span style="background: linear-gradient(45deg, #3498db, #2980b9); padding: 0.5rem 1rem; border-radius: 15px;">2¬∫ OpenAI API</span>
                    <span style="background: linear-gradient(45deg, #f39c12, #e67e22); padding: 0.5rem 1rem; border-radius: 15px;">3¬∫ OpenRouter API</span>
                    <span style="background: linear-gradient(45deg, #95a5a6, #7f8c8d); padding: 0.5rem 1rem; border-radius: 15px;">4¬∫ Sistema Nativo</span>
                </div>
                <p style="font-size: 0.9rem; opacity: 0.9; color: #bdc3c7;">‚úÖ Rate Limiting Ativo | ‚úÖ Logging Estruturado | ‚úÖ 99% Uptime</p>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let botCount = 147;
        let messageCount = 8937;
        let currentExtractedData = null;

        // Fun√ß√£o principal para criar chatbot
        async function createChatbot() {
            const robotName = document.getElementById('robotName').value || '@arsenal.secreto';
            const pageUrl = document.getElementById('pageUrl').value;
            const instructions = document.getElementById('instructions').value;
            const btn = document.getElementById('createChatbotBtn');

            if (!pageUrl) {
                alert('‚ùå Por favor, insira a URL da p√°gina.');
                return;
            }

            // Estado de loading
            btn.classList.add('loading');
            btn.textContent = 'üîÑ Extraindo dados da p√°gina...';
            btn.disabled = true;

            try {
                // 1. Extrair dados da p√°gina
                console.log('üîç Iniciando extra√ß√£o de dados...');
                const extractResponse = await fetch('/extract', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url: pageUrl })
                });

                if (!extractResponse.ok) {
                    throw new Error(`Erro na extra√ß√£o: ${extractResponse.status}`);
                }

                const extractData = await extractResponse.json();
                console.log('‚úÖ Dados extra√≠dos:', extractData);

                if (extractData.success && extractData.data) {
                    currentExtractedData = extractData.data;
                    
                    // Mostrar dados extra√≠dos
                    const resultDiv = document.getElementById('extractionResult');
                    const contentDiv = document.getElementById('extractedContent');
                    
                    contentDiv.innerHTML = `
                        <p><strong>T√≠tulo:</strong> ${extractData.data.title}</p>
                        <p><strong>Descri√ß√£o:</strong> ${extractData.data.description}</p>
                        <p><strong>Conte√∫do:</strong> ${extractData.data.content.substring(0, 200)}...</p>
                    `;
                    resultDiv.style.display = 'block';

                    // Atualizar c√≥digo do widget
                    document.getElementById('widgetRobotName').textContent = robotName;
                    
                    // 2. Testar chat com dados extra√≠dos
                    btn.textContent = 'ü§ñ Configurando IA...';
                    
                    const testMessage = "Ol√°! Como voc√™ pode me ajudar?";
                    const chatResponse = await fetch('/chat-universal', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            message: testMessage,
                            robotName: robotName,
                            instructions: instructions,
                            extractedData: currentExtractedData
                        })
                    });

                    if (chatResponse.ok) {
                        const chatData = await chatResponse.json();
                        console.log('‚úÖ Chat funcionando:', chatData);
                        
                        // Adicionar resposta ao preview
                        const messagesDiv = document.getElementById('chatMessages');
                        if (chatData.success && chatData.response) {
                            messagesDiv.innerHTML += `
                                <div class="chat-message user">${testMessage}</div>
                                <div class="chat-message">${chatData.response}</div>
                            `;
                            messagesDiv.scrollTop = messagesDiv.scrollHeight;
                        }
                    }

                    // Sucesso
                    btn.classList.remove('loading');
                    btn.classList.add('success');
                    btn.textContent = '‚úÖ Chatbot Ativado com Sucesso!';
                    
                    // Incrementar contador
                    botCount++;
                    document.getElementById('botsCount').textContent = botCount;
                    
                } else {
                    throw new Error('Falha na extra√ß√£o de dados');
                }

            } catch (error) {
                console.error('‚ùå Erro:', error);
                btn.classList.remove('loading');
                btn.classList.add('error');
                btn.textContent = '‚ùå Erro na cria√ß√£o do chatbot';
                
                alert(`‚ùå Erro: ${error.message}\n\nVerifique:\n- URL v√°lida e acess√≠vel\n- Conex√£o com a internet\n- APIs configuradas`);
            }

            // Resetar bot√£o ap√≥s 3 segundos
            setTimeout(() => {
                btn.classList.remove('loading', 'success', 'error');
                btn.textContent = 'üöÄ Ativar Chatbot Inteligente';
                btn.disabled = false;
            }, 3000);
        }

        // Fun√ß√£o para enviar mensagem no preview
        async function sendPreviewMessage() {
            const input = document.getElementById('previewInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const messagesDiv = document.getElementById('chatMessages');
            const robotName = document.getElementById('robotName').value || 'Assistente';
            const instructions = document.getElementById('instructions').value;
            
            // Adicionar mensagem do usu√°rio
            messagesDiv.innerHTML += `<div class="chat-message user">${message}</div>`;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            // Limpar input
            input.value = '';
            
            // Mostrar typing
            messagesDiv.innerHTML += `<div class="chat-message" id="typing">ü§ñ Digitando...</div>`;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            try {
                const response = await fetch('/chat-universal', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        robotName: robotName,
                        instructions: instructions,
                        extractedData: currentExtractedData
                    })
                });

                // Remover typing
                document.getElementById('typing')?.remove();

                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.response) {
                        messagesDiv.innerHTML += `<div class="chat-message">${data.response}</div>`;
                        
                        // Incrementar contador de mensagens
                        messageCount++;
                        document.getElementById('messagesCount').textContent = messageCount;
                    } else {
                        messagesDiv.innerHTML += `<div class="chat-message">‚ùå ${data.fallbackResponse || 'Erro na resposta'}</div>`;
                    }
                } else {
                    messagesDiv.innerHTML += `<div class="chat-message">‚ùå Erro de conex√£o. Tente novamente.</div>`;
                }

            } catch (error) {
                document.getElementById('typing')?.remove();
                messagesDiv.innerHTML += `<div class="chat-message">‚ùå Erro: ${error.message}</div>`;
            }
            
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // Fun√ß√£o para compartilhamento social
        function shareToSocial(platform) {
            const pageUrl = document.getElementById('pageUrl').value || window.location.href;
            const robotName = document.getElementById('robotName').value || 'LinkM√°gico';
            
            const urls = {
                whatsapp: `https://api.whatsapp.com/send?text=Conhe√ßa o ${robotName} - IA Conversacional: ${pageUrl}`,
                telegram: `https://t.me/share/url?url=${pageUrl}&text=${robotName} - IA Conversacional`,
                facebook: `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`,
                youtube: 'https://studio.youtube.com',
                tiktok: 'https://www.tiktok.com/upload',
                twitter: `https://twitter.com/intent/tweet?text=Conhe√ßa o ${robotName}&url=${pageUrl}`,
                instagram: 'https://www.instagram.com',
                linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`,
                messenger: `https://www.messenger.com/t/?link=${pageUrl}`,
                prompt: '/docs#prompts',
                kwai: 'https://www.kwai.com'
            };

            if (urls[platform]) {
                window.open(urls[platform], '_blank', 'noopener,noreferrer');
            }
        }

        // Fun√ß√£o para abrir analytics
        function openAnalytics() {
            window.open('/dashboard/demo', '_blank');
        }

        // Event listener para Enter no chat preview
        document.getElementById('previewInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendPreviewMessage();
            }
        });

        // Atualizar contadores em tempo real
        setInterval(() => {
            if (Math.random() > 0.8) {
                messageCount += Math.floor(Math.random() * 2) + 1;
                document.getElementById('messagesCount').textContent = messageCount;
                
                // Simular tempo de resposta
                const times = ['1s', '2s', '3s', '2s', '1s'];
                document.getElementById('responseTime').textContent = times[Math.floor(Math.random() * times.length)];
            }
        }, 8000);

        // Verificar status das APIs no carregamento
        async function checkAPIStatus() {
            try {
                const response = await fetch('/status');
                const data = await response.json();
                console.log('üìä Status das APIs:', data);
                
                // Atualizar indicador visual
                const indicators = document.querySelectorAll('.status-indicator');
                indicators.forEach(indicator => {
                    indicator.style.background = '#00ff88';
                    indicator.style.boxShadow = '0 0 10px #00ff88';
                });
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Status das APIs indispon√≠vel:', error);
                
                // Indicador de warning
                const indicators = document.querySelectorAll('.status-indicator');
                indicators.forEach(indicator => {
                    indicator.style.background = '#f39c12';
                    indicator.style.boxShadow = '0 0 10px #f39c12';
                });
            }
        }

        // Inicializar aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ LinkM√°gico v6.0 + v7.0 inicializado');
            checkAPIStatus();
            
            // Focar no primeiro input
            document.getElementById('robotName').focus();
        });

        // Auto-save no localStorage (para UX)
        function autoSave() {
            const robotName = document.getElementById('robotName').value;
            const pageUrl = document.getElementById('pageUrl').value;
            const instructions = document.getElementById('instructions').value;
            
            localStorage.setItem('linkmagico_robotName', robotName);
            localStorage.setItem('linkmagico_pageUrl', pageUrl);
            localStorage.setItem('linkmagico_instructions', instructions);
        }

        // Auto-load do localStorage
        function autoLoad() {
            const robotName = localStorage.getItem('linkmagico_robotName');
            const pageUrl = localStorage.getItem('linkmagico_pageUrl');
            const instructions = localStorage.getItem('linkmagico_instructions');
            
            if (robotName) document.getElementById('robotName').value = robotName;
            if (pageUrl) document.getElementById('pageUrl').value = pageUrl;
            if (instructions) document.getElementById('instructions').value = instructions;
        }

        // Event listeners para auto-save
        document.getElementById('robotName').addEventListener('input', autoSave);
        document.getElementById('pageUrl').addEventListener('input', autoSave);
        document.getElementById('instructions').addEventListener('input', autoSave);

        // Carregar dados salvos
        autoLoad();

    </script>
</body>
</html>